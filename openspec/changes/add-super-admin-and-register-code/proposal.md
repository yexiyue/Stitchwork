# Proposal: Add Super Admin and Registration Code

## Summary

添加超级管理员角色和注册码机制，控制工坊主（Boss）的注册权限。

## Problem

当前任何人都可以通过 `/register` 注册成为工坊主，这在公网部署时存在安全风险：
- 无法控制谁可以创建工坊
- 无法追踪注册来源
- 服务器资源可能被滥用

## Solution

1. **超级管理员角色**：用户表增加 `is_super_admin` 字段，超管可以管理注册码和用户
2. **注册码机制**：工坊主注册时必须提供有效的注册码，注册码由超管创建，只能使用一次

## Scope

### In Scope
- 用户表增加 `is_super_admin` 字段
- 新增 `register_code` 表
- 注册码 CRUD API（超管专用）
- 用户列表 API（超管专用）
- 注册接口增加注册码校验
- 超管前端页面（注册码管理、用户管理）
- 注册时手机号必填（Boss 和 Staff）
- 支持手机号登录（手机号或用户名均可）
- 手机号唯一约束

### Out of Scope
- 多级管理员权限
- 用户禁用功能（后续迭代）
- 工坊管理功能
- 手机验证码验证（未来迭代）

## Design Decisions

1. **超管不关联工坊**：超管是纯平台管理角色，与工坊业务完全分离
2. **注册码一次性**：简化逻辑，用 `used_by` 字段标记是否已使用
3. **首个超管手动设置**：通过数据库 SQL 设置，避免安全漏洞

## Dependencies

- 现有 auth 模块
- 现有 user entity

## Risks

- 已存在的工坊主账号不受影响，无需迁移
- 注册码机制上线后，新工坊主必须通过注册码注册
